# Telegram Bot с микросервисной архитектурой

Проект представляет собой Telegram-бота с микросервисной архитектурой, использующего ИИ-модель для генерации ответов.

## Архитектура

Проект состоит из следующих микросервисов:

1. **API Gateway** - входная точка для взаимодействия с Telegram API
2. **Auth Service** - сервис авторизации пользователей
3. **Dialogue Service** - сервис управления диалогами и контекстом
4. **ML Service** - сервис для взаимодействия с ИИ-моделью
5. **DB Service** - сервис для управления базой данных

## Структура проекта

```
.
├── api_gateway.py          # Сервис API Gateway
├── auth_service.py         # Сервис авторизации
├── dialogue_service.py     # Сервис диалогов
├── ml_service.py           # Сервис ML-модели
├── db_service.py           # Сервис базы данных
├── docker-compose.yml      # Файл конфигурации Docker Compose
├── .env                    # Файл с переменными окружения
├── dockerfiles/            # Директория с Dockerfile'ами
│   ├── api-gateway.dockerfile
│   ├── auth-service.dockerfile
│   ├── dialogue-service.dockerfile
│   ├── ml-service.dockerfile
│   └── db-service.dockerfile
└── requirements.*.txt      # Файлы с зависимостями для каждого сервиса
```

## Подготовка к запуску

1. Скопируйте файл `.env.example` в `.env` и заполните необходимые переменные окружения:
   ```
   cp .env.example .env
   ```

2. Отредактируйте файл `.env`, указав токен вашего бота Telegram и другие необходимые параметры.

3. Сгенерируйте ключ шифрования для AES-256:
   ```
   python -c "import os; import base64; print(base64.b64encode(os.urandom(32)).decode())"
   ```
   и вставьте сгенерированный ключ в переменную `ENCRYPTION_KEY` в файле `.env`.

## Запуск проекта

Для запуска проекта выполните команду:

```bash
docker-compose up -d
```

Это запустит все необходимые сервисы в контейнерах Docker.

## Проверка статуса сервисов

```bash
docker-compose ps
```

## Логи сервисов

```bash
docker-compose logs -f [service_name]
```

## Остановка проекта

```bash
docker-compose down
```

## Функциональность бота

- **Авторизация пользователей** - для доступа к полным ответам пользователи должны предоставить номер телефона
- **Хранение истории диалогов** - все сообщения сохраняются в базе данных
- **Генерация ответов с использованием ИИ** - для генерации ответов используется модель Llama-2-7b-chat-hf

## Безопасность

- Данные пользователей (номера телефонов, сообщения) шифруются с использованием AES-256
- Доступ к полным ответам возможен только для авторизованных пользователей

## Масштабирование

Проект легко масштабируется благодаря микросервисной архитектуре. Вы можете запустить несколько экземпляров любого сервиса для увеличения производительности.
